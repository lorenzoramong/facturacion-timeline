<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CAMINO GDC</title>
 
<style>
  body {
    margin: 0;
    font-family: "Inter", sans-serif;
    background: #fff;
    color: #222;
  }
 
  /* Encabezado */
  .hero {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 60px 20px 40px;
    gap: 20px;
    background: linear-gradient(135deg, #eaf6ff, #d3f7e4);
    border-bottom: 1px solid #e3eaf0;
  }
 
  .hero-logo {
    width: 95px;
    height: 95px;
    object-fit: contain;
    animation: float 3s ease-in-out infinite;
  }
 
  @keyframes float {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }
 
  .hero-text h1 {
    font-size: 2.4rem;
    font-weight: 700;
    margin: 0;
    color: #0072bb;
  }
 
  .hero-text p {
    margin: 8px 0 0;
    color: #444;
  }
 
  /* Filtros */
  .filters {
    display: flex;
    flex-direction: column;
    position: fixed;
    left: 20px;
    top: 260px;
    gap: 10px;
    background: #ffffffd0;
    backdrop-filter: blur(8px);
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
  }
 
  select, input {
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
 
  /* L칤nea de a침os */
  .main-timeline {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 90px;
    margin: 70px auto;
    padding: 10px;
    max-width: 1100px;
    position: relative;
  }
 
  .main-timeline::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 5%;
    right: 5%;
    height: 4px;
    background: linear-gradient(90deg, #0072bb, #7cc242);
  }
 
  .year-node {
    background: #fff;
    border: 4px solid #0072bb;
    border-radius: 50%;
    width: 75px;
    height: 75px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    cursor: pointer;
    transition: .25s;
  }
 
  .year-node.active {
    background: #7cc242;
    color: #fff;
    border-color: #7cc242;
  }
 
  .year-node:hover {
    transform: scale(1.1);
    background: #0072bb;
    color: #fff;
  }
 
  /* Detalle a침o */
  .year-details {
    display: none;
    flex-direction: column;
    align-items: center;
    margin-top: 40px;
  }
 
  .year-details.active {
    display: flex;
    animation: fadeIn .5s;
  }
 
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
 
  .events-line {
    width: 3px;
    background: #0072bb55;
    height: 100%;
    margin-bottom: 20px;
  }
 
  .event {
    width: 300px;
    padding: 16px;
    background: #f9f9f9;
    margin: 20px 0;
    border-left: 6px solid #0072bb;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 0 5px 12px rgba(0,0,0,.06);
    transition: .25s;
  }
 
  .event:hover {
    transform: translateY(-4px);
  }
 
  .event .date {
    color: #7cc242;
    font-weight: 600;
  }
 
  /* Bot칩n abrir panel */
  #openPanelBtn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: linear-gradient(90deg, #0072bb, #7cc242);
    color: white;
    padding: 14px 22px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    border: none;
    box-shadow: 0 4px 12px rgba(0,0,0,.2);
  }
 
  /* Panel lateral */
  #sidePanel {
    position: fixed;
    right: -400px;
    top: 0;
    width: 340px;
    height: 100vh;
    background: #ffffffee;
    backdrop-filter: blur(6px);
    box-shadow: -3px 0 10px rgba(0,0,0,.1);
    padding: 20px;
    transition: .4s;
  }
 
  #sidePanel.open {
    right: 0;
  }
 
  #sidePanel h2 {
    color: #0072bb;
    margin-bottom: 10px;
  }
 
  #sidePanel input, #sidePanel textarea {
    width: 100%;
    margin-bottom: 12px;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }
 
  #sidePanel button {
    width: 100%;
    padding: 12px;
    background: #0072bb;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 8px;
  }
 
  /* Modal */
  #modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width:100%; height:100%;
    background: rgba(0,0,0,.5);
    justify-content: center;
    align-items: center;
  }
 
  #modalContent {
    width: 360px;
    background: white;
    padding: 22px;
    border-radius: 12px;
  }
</style>
</head>
 
<body>
 
<!-- Encabezado -->
<header class="hero">
<img src="logo-gases.png" class="hero-logo">
<div class="hero-text">
<h1>CAMINO GDC</h1>
<p>Explor치 los hitos m치s importantes por a침o</p>
</div>
</header>
 
<!-- Filtros -->
<div class="filters">
<select id="filterYear">
<option value="">A침o</option>
</select>
 
  <select id="filterType">
<option value="">Tipo</option>
<option value="Migraci칩n">Migraci칩n</option>
<option value="Error">Error</option>
<option value="Automatizaci칩n">Automatizaci칩n</option>
</select>
 
  <input id="filterKeyword" placeholder="Buscar..." />
</div>
 
<!-- L칤nea de tiempo -->
<section class="main-timeline" id="timeline"></section>
 
<!-- Contenedores por a침o -->
<div id="yearDetailContainer"></div>
 
<!-- Bot칩n abrir panel -->
<button id="openPanelBtn">+ Crear Hito</button>
 
<!-- Panel lateral -->
<div id="sidePanel">
<h2>Crear Hito</h2>
 
  <input id="dateInput" type="date">
<input id="titleInput" placeholder="T칤tulo">
<input id="detailInput" placeholder="Detalle breve (8 palabras)">
<textarea id="descriptionInput" placeholder="Descripci칩n"></textarea>
<input id="typeInput" placeholder="Tipo">
<input id="impactInput" placeholder="Impacto">
<input id="authorInput" placeholder="Autor">
 
  <button id="submitHito">Guardar Hito</button>
</div>
 
<!-- Modal -->
<div id="modal">
<div id="modalContent">
<h2 id="modalTitle"></h2>
<p id="modalDate"></p>
<p id="modalDesc"></p>
<p id="modalExtra"></p>
</div>
</div>
 
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
 
<script>
/* 游댠 TU CONFIG DE FIREBASE AQU칈 */
const firebaseConfig = {
  apiKey: "AIzaSyABOt5v_tBFjXttFlogHPnOY9l_T_a7g0c",
  authDomain: "camino-gdc.firebaseapp.com",
  projectId: "camino-gdc",
  storageBucket: "camino-gdc.firebasestorage.app",
  messagingSenderId: "1053392006260",
  appId: "1:1053392006260:web:8c39450408566f14987521"
};
 
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
 
/* 游댏 Proteger PAGE */
auth.onAuthStateChanged(user => {
  if (!user) window.location.href = "login.html";
});
</script>
 
<!-- L칍GICA PRINCIPAL -->
<script>
const SHEET_ID = "13SfGnF5EZduKG6_NjeCWPeY63uR48yEfvVTyGF6j_bA";
const API_KEY = "AIzaSyDI7q9YVBaK24yBQtP08SU4uOJiFsXmMaQ";
const SHEET_NAME = "Hitos";

 /* Construir a침os din치micos */
async function construirAnios() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();
  if (!data.values) return;
 
  const rows = data.values.slice(1);
  const years = [...new Set(rows.map(r => new Date(r[0]).getFullYear()))];
 
  const timeline = document.getElementById("timeline");
  timeline.innerHTML = "";
 
  years.forEach(y => {
    const el = document.createElement("div");
    el.className = "year-node";
    el.dataset.year = y;
    el.textContent = y;
    timeline.appendChild(el);
  });
 
  const container = document.getElementById("yearDetailContainer");
  container.innerHTML = "";
  years.forEach(y => {
    container.innerHTML += `<section class="year-details" id="details-${y}">
<div class="events-line"></div>
</section>`;
  });
 
  activarClicksAnios();
  cargarHitos();
}
 
/* Activar click */
function activarClicksAnios() {
  const nodes = document.querySelectorAll(".year-node");
  const details = document.querySelectorAll(".year-details");
 
  nodes.forEach(n => {
    n.onclick = () => {
      nodes.forEach(x => x.classList.remove("active"));
      details.forEach(d => d.classList.remove("active"));
      n.classList.add("active");
 
      document.getElementById("details-"+n.dataset.year).classList.add("active");
    };
  });
}
 
/* Cargar hitos */
async function cargarHitos() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();
  if (!data.values) return;
 
  const rows = data.values.slice(1);
 
  rows.forEach(r => {
    const [fecha,titulo,detalle,descripcion,tipo,impacto,autor] = r;
    const y = new Date(fecha).getFullYear();
    const cont = document.getElementById("details-"+y);
    if (!cont) return;
 
    const el = document.createElement("div");
    el.className = "event";
    el.setAttribute("data-year", y);
    el.setAttribute("data-type", tipo.toLowerCase());
    el.setAttribute("data-title", titulo.toLowerCase());
    el.setAttribute("data-detalle", detalle.toLowerCase());
 
    el.innerHTML = `
<div class="date">${fecha}</div>
<h3>${titulo}</h3>
<p>${detalle}</p>
    `;
 
    el.onclick = () => abrirModal(titulo,fecha,descripcion,tipo,impacto,autor);
    cont.appendChild(el);
  });
}
 
/* Modal */
function abrirModal(t,f,d,tipo,i,a) {
  modal.style.display = "flex";
  modalTitle.textContent = t;
  modalDate.textContent = f;
  modalDesc.textContent = d;
  modalExtra.innerHTML = `
<b>Tipo:</b> ${tipo}<br>
<b>Impacto:</b> ${i}<br>
<b>Autor:</b> ${a}<br>
  `;
 
  modal.onclick = e => { if(e.target.id==="modal") modal.style.display="none"; };
}
 
/* Panel lateral */
openPanelBtn.onclick = () => sidePanel.classList.add("open");
document.addEventListener("keydown", e => { if(e.key==="Escape") sidePanel.classList.remove("open"); });
 
/* Guardar hito */
submitHito.onclick = async () => {
  const obj = {
    fecha: dateInput.value,
    titulo: titleInput.value,
    detalle: detailInput.value,
    descripcion: descriptionInput.value,
    tipo: typeInput.value,
    impacto: impactInput.value,
    autor: authorInput.value
  };
 
  await fetch("https://script.google.com/macros/s/AKfycbyjthogZdAEo1Irk_Dy8cgiJyG2o4YHgdzf2hC5a-3V1A7VZOMemGa4ilvNWcp_-gSX/exec", {
    method:"POST",
    body: JSON.stringify(obj)
  });
 
  alert("Hito guardado");
  location.reload();
};
 
window.onload = construirAnios;
</script>
 
</body>
</html>
